{% load static %}
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Robert's Lackwerk</title>
    <link rel="icon" type="image/png" href="{% static 'img/RLicon.png' %}">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Design System CSS -->
    <link rel="stylesheet" href="{% static 'css/design/variables.css' %}">
    <link rel="stylesheet" href="{% static 'css/design/layout.css' %}">
    <link rel="stylesheet" href="{% static 'css/design/components.css' %}">
    <link rel="stylesheet" href="{% static 'css/figma.css' %}">
</head>
<script>
document.addEventListener('DOMContentLoaded',function(){
  document.querySelectorAll('.progress-bar[data-progress]').forEach(function(el){
    var p = el.getAttribute('data-progress');
    if(p){ el.style.width = p + '%'; }
  });
});
</script>
<body class="page-bg {% block body_class %}{% endblock %}" data-ga-id="{{ GA_MEASUREMENT_ID }}">
    <nav class="navbar navbar-expand-lg navbar-dark rl-nav">
      <div class="container-fluid rl-nav-inner">
        <a class="navbar-brand rl-nav__brand" href="{% url 'home' %}">
          <img src="{% static 'img/RL_logo2.png' %}" alt="Robert's Lackwerk" class="rl-nav__logo" decoding="async">
        </a>
        <a href="{% url 'schaden_melden' %}" class="btn btn-primary rl-nav__cta rl-nav__cta--mobile js-start-modal">Jetzt starten</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse rl-nav__links" id="navbarNav">
          <ul class="navbar-nav ms-auto rl-nav__list">
            <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}" href="{% url 'home' %}">Startseite</a></li>
            <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'schaden_melden' %}active{% endif %}" href="{% url 'schaden_melden' %}">Schadenmeldung</a></li>
            <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'mietfahrzeuge' %}active{% endif %}" href="{% url 'mietfahrzeuge' %}">Vermietung</a></li>
            <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'ueber_uns' %}active{% endif %}" href="{% url 'ueber_uns' %}">Über uns</a></li>
          </ul>
          <a href="{% url 'schaden_melden' %}" class="btn btn-primary rl-nav__cta rl-nav__cta--desktop js-start-modal">Jetzt starten</a>
        </div>
      </div>
    </nav>
    <main class="page-main">
      <div class="page-container">
        {% block content %}{% endblock %}
      </div>
    </main>

     {% include "partials/footer.html" %} 
     {% include "partials/cookie_banner.html" %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://unpkg.com/lucide@latest"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    if (window.lucide) {
      lucide.createIcons();
    }

    // Set max today for date inputs
    const today = new Date().toISOString().split('T')[0];
    document.querySelectorAll('input[data-max-today="true"]').forEach(function(el){
      el.setAttribute('max', today);
    });

    // Basic file size/type check for inputs carrying data-max-size (MB)
    document.querySelectorAll('input[type="file"][data-max-size]').forEach(function(el){
      el.addEventListener('change', function(ev){
        const maxMB = parseInt(el.dataset.maxSize || '5', 10);
        const maxBytes = maxMB * 1024 * 1024;
        const allowed = (el.getAttribute('accept') || '').split(',').filter(Boolean);
        for (const file of el.files) {
          if (file.size > maxBytes) {
            alert(`Datei ${file.name} ist zu groß. Maximal ${maxMB} MB.`);
            el.value = '';
            return;
          }
          if (allowed.length && !allowed.includes(file.type)) {
            alert(`Datei ${file.name} hat einen ungültigen Typ (${file.type}).`);
            el.value = '';
            return;
          }
        }
      });
    });
  });
</script>
<script>
  (function () {
    const key = 'rl_cookie_consent';
    const consent = localStorage.getItem(key);
    const gaId = document.body.getAttribute('data-ga-id');
    if (consent === 'accepted' && gaId) {
      const script = document.createElement('script');
      script.async = true;
      script.src = 'https://www.googletagmanager.com/gtag/js?id=' + gaId;
      document.head.appendChild(script);
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', gaId);
    }
  })();
</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const modalEl = document.getElementById('rlStartModal');
    if (!modalEl || !window.bootstrap) {
      return;
    }
    const modal = new bootstrap.Modal(modalEl);
    document.querySelectorAll('.js-start-modal').forEach(function (btn) {
      btn.addEventListener('click', function (event) {
        event.preventDefault();
        modal.show();
      });
    });
  });
</script>
  </body>
</html>

<div class="modal fade rl-start-modal" id="rlStartModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header rl-start-modal__header">
        <h5 class="modal-title">Willkommen bei Robert's Lackwerk</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Schließen"></button>
      </div>
      <div class="modal-body">
        <p>Wir freuen, dass Sie die Dienstleistung von Robert's Lackwerk in Anspruch nehmen möchten. Mit welcher Dienstleistung möchten Sie fortfahren?</p>
        <div class="rl-start-modal__actions">
          <a class="btn rl-start-modal__btn rl-start-modal__btn--solid" href="{% url 'schaden_melden' %}">Schaden melden</a>
          <a class="btn rl-start-modal__btn rl-start-modal__btn--outline" href="{% url 'mietfahrzeuge' %}">Transporter mieten</a>
        </div>
      </div>
    </div>
  </div>
</div>
